{% extends "base.html" %}
{% load static %}
{% block header_css %}
<link href="{% static 'vendor/datatables/dataTables.bootstrap4.min.css' %}" rel="stylesheet">
{% endblock header_css %}
{% block content %}
        <!-- Begin Page Content -->
        <div class="container-fluid">

          <!-- Page Heading -->
          <div class="d-sm-flex align-items-center justify-content-between mb-4">
            <h1 class="h3 mb-0 text-gray-800">Dashboard</h1>
            <!-- <a href="#" class="d-none d-sm-inline-block btn btn-sm btn-primary shadow-sm"><i class="fas fa-download fa-sm text-white-50"></i> Generate Report</a> -->
          </div>
          <ul class="nav nav-tabs">
            <li class="nav-item">
              <a class="nav-link" href="{% url 'dashboard' %}">Recent</a>
            </li>
            <li class="nav-item">
              <a class="nav-link active " href="{% url 'dashboard_daily_report' %}">Daily Report</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="{% url 'dashboard_project' %}">Project</a>
            </li>
          </ul>


          <!-- Content Row -->



          <!-- Content Row -->
          <div class="row">
            <div class="container-fluid">
                <!-- Page Heading -->
                <h1 class="h3 mt-3 text-gray-800">Daily Reports</h1>
                <div class="mb-4 text-right">
                    <a href="#" class=" btn btn-sm btn-primary shadow-sm"><i class="fas fa-download fa-sm text-white-50"></i> Generate Report</a>
                    <!-- <a href="{% url 'create_daily_report' %}" data-toggle="modal" data-target="#newReportForm" class="  btn btn-sm btn-primary shadow-sm"><i class="fas fa-edit fa-sm text-white-50"></i> Add Daily report</a> -->
                    <a href="{% url 'create_daily_report' %}" data-toggle="modal" data-target="#ReportForm" class="btn btn-sm btn-primary shadow-sm">Add Daily Report</a></span>
                  </div>

              <!-- DataTales Example -->
              <div class="card shadow mb-4">
                <div class="card-body">
                  <div class="table-responsive">
                    <table class="table table-bordered" id="dailyreportTable" width="100%" cellspacing="0">
                      <thead>
                        <tr>
                          <th>Description</th>
                          <th>Project</th>
                          <th>Service Type</th>
                          <th>Call Date</th>
                          <th>Response Time</th>
                          <th>Responsed By</th>
                          <th></th>
                        </tr>
                      </thead>
                      <tbody>
                        {% for report in daily_reports %}
                        <tr>
                          <td>{{report.description}}</td>
                          <td><a href="{% url 'project_detail' report.project.id %}" >{{report.project.name}}</a></td>
                          <td>{{report.get_service_type_display }}</td>
                          <td>{{report.call_date}}</td>
                          <td>{{report.response_time}}</td>
                          <td>{{report.response_by}}</td>
                          <td><a href="{% url 'update_daily_report' report.id %}" class="btn btn-outline-primary" data-toggle="modal" data-target="#ReportForm">Edit</a></td>
                        </tr>
                        {% endfor %}
                      </tbody>
                    </table>
                  </div>
                </div>
              </div>
    
            </div>
          </div>

        </div>
        <!-- /.container-fluid -->
{% endblock content %}

{% block modal%}
  <!-- New Daily Report Modal -->
  <div class="modal fade" data-backdrop="static" id="ReportForm" tabindex="-1" role="dialog" aria-labelledby="newReportForm" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered" role="document">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="exampleModalLabel">New Daily Report</h5>
          <button class="close" type="button" data-dismiss="modal" aria-label="Close">
            <span aria-hidden="true">Ã—</span>
          </button>
        </div>
        <div class="modal-body">
        </div>
        </div>

      </div>
    </div>


{% endblock modal %}

{% block body_script %}
<script src="{% static 'vendor/datatables/jquery.dataTables.min.js' %}"></script>
<script src="{% static 'vendor/datatables/dataTables.bootstrap4.min.js' %}"></script>

<script>
  $(document).ready(function(){
    $('#dailyreportTable').DataTable();
    });
    $('#ReportForm').on('show.bs.modal', function (e) {
        var url =  $(e.relatedTarget).attr('href');
        $.get(url, function(res){
          console.log(res)
          $('.modal-body').html(res);
        }).done(function(){
          $('.date-time').bootstrapMaterialDatePicker({ format : "MM/DD/YYYY HH:mm" });
        });
    });
    $('#ReportForm').on('hidden.bs.modal', function (e) {
        var url =  $(e.relatedTarget).attr('url');
          $('.modal-body').html("")

    });

    
</script>
{% endblock body_script %}